import{_ as w}from"./demo-DcH_UwcN.js";import{_ as v,A as h,$ as W,o as x,G as g,c as k,d,L as y,a8 as l,ah as C,b as a,e as E,f as u,ab as f,ae as b}from"./index-BOUM_9ip.js";const B={src:w,controls:"",autoplay:"",loop:"",ref:"videlRef"},P={__name:"任意元素画中画",setup(R){const o=h(),e=W({pipWindow:null,observerThreshold:1});x(()=>{documentPictureInPicture.addEventListener("enter",p=>{console.log("画中画已开启"),e.pipWindow=p.window,console.log("pipWindow",e.pipWindow);let n=o.value.parentElement,t=document.createElement("div");t.textContent="画中画模式已开启",console.log(o.value,o.value.offsetWidth),t.style.cssText=`
			width: ${o.value.offsetWidth}px;
			height: ${o.value.offsetHeight}px;
			background: #0014;
			color: #fffe; 
			border-radius: 4px;
			font-size: 20px; 
			display: flex;
			justify-content: center;
			align-items: center; `,n.insertBefore(t,o.value),e.pipWindow.document.body.appendChild(o.value),[...document.styleSheets].forEach(s=>{try{const r=[...s.cssRules].map(_=>_.cssText).join(" "),i=document.createElement("style");i.textContent=r,e.pipWindow.document.head.appendChild(i)}catch{const i=document.createElement("link");i.rel="stylesheet",i.type=s.type,i.media=s.media,i.href=s.href,e.pipWindow.document.head.appendChild(i)}}),e.pipWindow.addEventListener("pagehide",s=>{console.log("画中画已关闭"),e.pipWindow=null,n.insertBefore(o.value,t),t.remove()}),e.pipWindow.addEventListener("focus",()=>{console.log("画中画已聚焦")}),e.pipWindow.addEventListener("blur",()=>{console.log("画中画已失焦")}),e.pipWindow.addEventListener("resize",function(){console.log("pipWindow",e.pipWindow)})})}),g(()=>{c()});function m(){documentPictureInPicture.requestWindow({width:635,height:440})}function c(){documentPictureInPicture.window?.close()}return(p,n)=>{const t=b,s=C;return a(),k("section",null,[d("main",null,[d("div",{class:"pipContainer",ref_key:"pipContainerRef",ref:o},[n[0]||(n[0]=d("h2",null,"这是一个将要放入画中画的容器",-1)),d("video",B,null,512)],512),y(s,null,{default:l(()=>[E(e).pipWindow?(a(),u(t,{key:0,onClick:c},{default:l(()=>n[1]||(n[1]=[f("关闭画中画")])),_:1})):(a(),u(t,{key:1,onClick:m},{default:l(()=>n[2]||(n[2]=[f("开启画中画")])),_:1}))]),_:1})])])}}},T=v(P,[["__scopeId","data-v-30b4d7dd"]]);export{T as default};
